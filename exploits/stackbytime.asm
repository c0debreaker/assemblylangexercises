// C source file: stack2.c
1) Current stack before program started
[----------------------------------registers-----------------------------------]
EAX: 0xf7fa8dbc --> 0xffffdebc --> 0xffffdfac ("PWD=/mnt/exercises/assembly/exploits")
EBX: 0x0
ECX: 0x8e1acc15
EDX: 0xffffde44 --> 0x0
ESI: 0x1
EDI: 0xf7fa7000 --> 0x1b3db0
EBP: 0x0
ESP: 0xffffde1c --> 0xf7e0b286 (<__libc_start_main+246>:	add    esp,0x10)
EIP: 0x56555573 (<main>:	push   ebp)
EFLAGS: 0x292 (carry parity ADJUST zero SIGN trap INTERRUPT direction overflow)
[------------------------------------stack-------------------------------------]
0000| 0xffffde1c --> 0xf7e0b286 (<__libc_start_main+246>:	add    esp,0x10)
0004| 0xffffde20 --> 0x1
0008| 0xffffde24 --> 0xffffdeb4 --> 0xffffdf85 ("/mnt/exercises/assembly/exploits/stack")
0012| 0xffffde28 --> 0xffffdebc --> 0xffffdfac ("PWD=/mnt/exercises/assembly/exploits")
0016| 0xffffde2c --> 0x0
0020| 0xffffde30 --> 0x0
0024| 0xffffde34 --> 0x0
0028| 0xffffde38 --> 0xf7fa7000 --> 0x1b3db0


2) After `=> 0x56555573 <main>:	push   ebp` was executed
[----------------------------------registers-----------------------------------]
EAX: 0xf7fa8dbc --> 0xffffdebc --> 0xffffdfac ("PWD=/mnt/exercises/assembly/exploits")
EBX: 0x0
ECX: 0x8e1acc15
EDX: 0xffffde44 --> 0x0
ESI: 0x1
EDI: 0xf7fa7000 --> 0x1b3db0
EBP: 0x0
ESP: 0xffffde18 --> 0x0
EIP: 0x56555574 (<main+1>:	mov    ebp,esp)
EFLAGS: 0x292 (carry parity ADJUST zero SIGN trap INTERRUPT direction overflow)
[------------------------------------stack-------------------------------------]
0000| 0xffffde18 --> 0x0
0004| 0xffffde1c --> 0xf7e0b286 (<__libc_start_main+246>:	add    esp,0x10)
0008| 0xffffde20 --> 0x1
0012| 0xffffde24 --> 0xffffdeb4 --> 0xffffdf85 ("/mnt/exercises/assembly/exploits/stack")
0016| 0xffffde28 --> 0xffffdebc --> 0xffffdfac ("PWD=/mnt/exercises/assembly/exploits")
0020| 0xffffde2c --> 0x0
0024| 0xffffde30 --> 0x0
0028| 0xffffde34 --> 0x0


3) After `=> 0x56555574 <main+1>:	mov    ebp,esp` 
[----------------------------------registers-----------------------------------]
EAX: 0xf7fa8dbc --> 0xffffdebc --> 0xffffdfac ("PWD=/mnt/exercises/assembly/exploits")
EBX: 0x0
ECX: 0x8e1acc15
EDX: 0xffffde44 --> 0x0
ESI: 0x1
EDI: 0xf7fa7000 --> 0x1b3db0
EBP: 0xffffde18 --> 0x0
ESP: 0xffffde18 --> 0x0
EIP: 0x56555576 (<main+3>:	call   0x56555591 <__x86.get_pc_thunk.ax>)
EFLAGS: 0x292 (carry parity ADJUST zero SIGN trap INTERRUPT direction overflow)
[------------------------------------stack-------------------------------------]
0000| 0xffffde18 --> 0x0
0004| 0xffffde1c --> 0xf7e0b286 (<__libc_start_main+246>:	add    esp,0x10)
0008| 0xffffde20 --> 0x1
0012| 0xffffde24 --> 0xffffdeb4 --> 0xffffdf85 ("/mnt/exercises/assembly/exploits/stack")
0016| 0xffffde28 --> 0xffffdebc --> 0xffffdfac ("PWD=/mnt/exercises/assembly/exploits")
0020| 0xffffde2c --> 0x0
0024| 0xffffde30 --> 0x0
0028| 0xffffde34 --> 0x0


4) After `=> 0x5655557b <main+8>:	add    eax,0x1a85`
[----------------------------------registers-----------------------------------]
EAX: 0x56557000 --> 0x1ef8
EBX: 0x0
ECX: 0x8e1acc15
EDX: 0xffffde44 --> 0x0
ESI: 0x1
EDI: 0xf7fa7000 --> 0x1b3db0
EBP: 0xffffde18 --> 0x0
ESP: 0xffffde18 --> 0x0
EIP: 0x56555580 (<main+13>:	push   0x3)
EFLAGS: 0x216 (carry PARITY ADJUST zero sign trap INTERRUPT direction overflow)
[------------------------------------stack-------------------------------------]
0000| 0xffffde18 --> 0x0
0004| 0xffffde1c --> 0xf7e0b286 (<__libc_start_main+246>:	add    esp,0x10)
0008| 0xffffde20 --> 0x1
0012| 0xffffde24 --> 0xffffdeb4 --> 0xffffdf85 ("/mnt/exercises/assembly/exploits/stack")
0016| 0xffffde28 --> 0xffffdebc --> 0xffffdfac ("PWD=/mnt/exercises/assembly/exploits")
0020| 0xffffde2c --> 0x0
0024| 0xffffde30 --> 0x0
0028| 0xffffde34 --> 0x0


5) After `=> 0x56555580 <main+13>:	push   0x3`
[----------------------------------registers-----------------------------------]
EAX: 0x56557000 --> 0x1ef8
EBX: 0x0
ECX: 0x8e1acc15
EDX: 0xffffde44 --> 0x0
ESI: 0x1
EDI: 0xf7fa7000 --> 0x1b3db0
EBP: 0xffffde18 --> 0x0
ESP: 0xffffde14 --> 0x3
EIP: 0x56555582 (<main+15>:	push   0x2)
EFLAGS: 0x216 (carry PARITY ADJUST zero sign trap INTERRUPT direction overflow)
[------------------------------------stack-------------------------------------]
0000| 0xffffde14 --> 0x3
0004| 0xffffde18 --> 0x0
0008| 0xffffde1c --> 0xf7e0b286 (<__libc_start_main+246>:	add    esp,0x10)
0012| 0xffffde20 --> 0x1
0016| 0xffffde24 --> 0xffffdeb4 --> 0xffffdf85 ("/mnt/exercises/assembly/exploits/stack")
0020| 0xffffde28 --> 0xffffdebc --> 0xffffdfac ("PWD=/mnt/exercises/assembly/exploits")
0024| 0xffffde2c --> 0x0
0028| 0xffffde30 --> 0x0


6) After `=> 0x56555582 <main+15>:	push   0x2`
[----------------------------------registers-----------------------------------]
EAX: 0x56557000 --> 0x1ef8
EBX: 0x0
ECX: 0x8e1acc15
EDX: 0xffffde44 --> 0x0
ESI: 0x1
EDI: 0xf7fa7000 --> 0x1b3db0
EBP: 0xffffde18 --> 0x0
ESP: 0xffffde10 --> 0x2
EIP: 0x56555584 (<main+17>:	push   0x1)
EFLAGS: 0x216 (carry PARITY ADJUST zero sign trap INTERRUPT direction overflow)
[------------------------------------stack-------------------------------------]
0000| 0xffffde10 --> 0x2
0004| 0xffffde14 --> 0x3
0008| 0xffffde18 --> 0x0
0012| 0xffffde1c --> 0xf7e0b286 (<__libc_start_main+246>:	add    esp,0x10)
0016| 0xffffde20 --> 0x1
0020| 0xffffde24 --> 0xffffdeb4 --> 0xffffdf85 ("/mnt/exercises/assembly/exploits/stack")
0024| 0xffffde28 --> 0xffffdebc --> 0xffffdfac ("PWD=/mnt/exercises/assembly/exploits")
0028| 0xffffde2c --> 0x0


7) After `=> 0x56555584 <main+17>:	push   0x1`
[----------------------------------registers-----------------------------------]
EAX: 0x56557000 --> 0x1ef8
EBX: 0x0
ECX: 0x8e1acc15
EDX: 0xffffde44 --> 0x0
ESI: 0x1
EDI: 0xf7fa7000 --> 0x1b3db0
EBP: 0xffffde18 --> 0x0
ESP: 0xffffde0c --> 0x1
EIP: 0x56555586 (<main+19>:	call   0x56555560 <function>)
EFLAGS: 0x216 (carry PARITY ADJUST zero sign trap INTERRUPT direction overflow)
[------------------------------------stack-------------------------------------]
0000| 0xffffde0c --> 0x1
0004| 0xffffde10 --> 0x2
0008| 0xffffde14 --> 0x3
0012| 0xffffde18 --> 0x0
0016| 0xffffde1c --> 0xf7e0b286 (<__libc_start_main+246>:	add    esp,0x10)
0020| 0xffffde20 --> 0x1
0024| 0xffffde24 --> 0xffffdeb4 --> 0xffffdf85 ("/mnt/exercises/assembly/exploits/stack")
0028| 0xffffde28 --> 0xffffdebc --> 0xffffdfac ("PWD=/mnt/exercises/assembly/exploits")


8) Right aftern entering function named function(1,2,3)
[----------------------------------registers-----------------------------------]
EAX: 0x56557000 --> 0x1ef8
EBX: 0x0
ECX: 0x8e1acc15
EDX: 0xffffde44 --> 0x0
ESI: 0x1
EDI: 0xf7fa7000 --> 0x1b3db0
EBP: 0xffffde18 --> 0x0
ESP: 0xffffde08 --> 0x5655558b (<main+24>:	add    esp,0xc)
EIP: 0x56555560 (<function>:	push   ebp)
EFLAGS: 0x216 (carry PARITY ADJUST zero sign trap INTERRUPT direction overflow)
[------------------------------------stack-------------------------------------]
0000| 0xffffde08 --> 0x5655558b (<main+24>:	add    esp,0xc)
0004| 0xffffde0c --> 0x1
0008| 0xffffde10 --> 0x2
0012| 0xffffde14 --> 0x3
0016| 0xffffde18 --> 0x0
0020| 0xffffde1c --> 0xf7e0b286 (<__libc_start_main+246>:	add    esp,0x10)
0024| 0xffffde20 --> 0x1
0028| 0xffffde24 --> 0xffffdeb4 --> 0xffffdf85 ("/mnt/exercises/assembly/exploits/stack")


9) After `=> 0x56555560 <function>:	push   ebp`
[----------------------------------registers-----------------------------------]
EAX: 0x56557000 --> 0x1ef8
EBX: 0x0
ECX: 0x8e1acc15
EDX: 0xffffde44 --> 0x0
ESI: 0x1
EDI: 0xf7fa7000 --> 0x1b3db0
EBP: 0xffffde18 --> 0x0
ESP: 0xffffde04 --> 0xffffde18 --> 0x0
EIP: 0x56555561 (<function+1>:	mov    ebp,esp)
EFLAGS: 0x216 (carry PARITY ADJUST zero sign trap INTERRUPT direction overflow)
[------------------------------------stack-------------------------------------]
0000| 0xffffde04 --> 0xffffde18 --> 0x0
0004| 0xffffde08 --> 0x5655558b (<main+24>:	add    esp,0xc)
0008| 0xffffde0c --> 0x1
0012| 0xffffde10 --> 0x2
0016| 0xffffde14 --> 0x3
0020| 0xffffde18 --> 0x0
0024| 0xffffde1c --> 0xf7e0b286 (<__libc_start_main+246>:	add    esp,0x10)
0028| 0xffffde20 --> 0x1


10) After `=> 0x56555561 <function+1>:	mov    ebp,esp`
[----------------------------------registers-----------------------------------]
EAX: 0x56557000 --> 0x1ef8
EBX: 0x0
ECX: 0x8e1acc15
EDX: 0xffffde44 --> 0x0
ESI: 0x1
EDI: 0xf7fa7000 --> 0x1b3db0
EBP: 0xffffde04 --> 0xffffde18 --> 0x0
ESP: 0xffffde04 --> 0xffffde18 --> 0x0
EIP: 0x56555563 (<function+3>:	sub    esp,0x10)
EFLAGS: 0x216 (carry PARITY ADJUST zero sign trap INTERRUPT direction overflow)
[------------------------------------stack-------------------------------------]
0000| 0xffffde04 --> 0xffffde18 --> 0x0
0004| 0xffffde08 --> 0x5655558b (<main+24>:	add    esp,0xc)
0008| 0xffffde0c --> 0x1
0012| 0xffffde10 --> 0x2
0016| 0xffffde14 --> 0x3
0020| 0xffffde18 --> 0x0
0024| 0xffffde1c --> 0xf7e0b286 (<__libc_start_main+246>:	add    esp,0x10)
0028| 0xffffde20 --> 0x1


11) After `=> 0x56555563 <function+3>:	sub    esp,0x10`
[----------------------------------registers-----------------------------------]
EAX: 0x56557000 --> 0x1ef8
EBX: 0x0
ECX: 0x8e1acc15
EDX: 0xffffde44 --> 0x0
ESI: 0x1
EDI: 0xf7fa7000 --> 0x1b3db0
EBP: 0xffffde04 --> 0xffffde18 --> 0x0
ESP: 0xffffddf4 --> 0xffffdeb4 --> 0xffffdf85 ("/mnt/exercises/assembly/exploits/stack")
EIP: 0x56555566 (<function+6>:	call   0x56555591 <__x86.get_pc_thunk.ax>)
EFLAGS: 0x282 (carry parity adjust zero SIGN trap INTERRUPT direction overflow)
[------------------------------------stack-------------------------------------]
0000| 0xffffddf4 --> 0xffffdeb4 --> 0xffffdf85 ("/mnt/exercises/assembly/exploits/stack")
0004| 0xffffddf8 --> 0xffffdebc --> 0xffffdfac ("PWD=/mnt/exercises/assembly/exploits")
0008| 0xffffddfc --> 0x565555c1 (<__libc_csu_init+33>:	lea    eax,[ebx-0x114])
0012| 0xffffde00 --> 0xf7fa73dc --> 0xf7fa81e0 --> 0x0
0016| 0xffffde04 --> 0xffffde18 --> 0x0
0020| 0xffffde08 --> 0x5655558b (<main+24>:	add    esp,0xc)
0024| 0xffffde0c --> 0x1
0028| 0xffffde10 --> 0x2


12) After `=> 0x56555571 <function+17>:	leave`
[----------------------------------registers-----------------------------------]
EAX: 0x56557000 --> 0x1ef8
EBX: 0x0
ECX: 0x8e1acc15
EDX: 0xffffde44 --> 0x0
ESI: 0x1
EDI: 0xf7fa7000 --> 0x1b3db0
EBP: 0xffffde18 --> 0x0
ESP: 0xffffde08 --> 0x5655558b (<main+24>:	add    esp,0xc)
EIP: 0x56555572 (<function+18>:	ret)
EFLAGS: 0x216 (carry PARITY ADJUST zero sign trap INTERRUPT direction overflow)
[------------------------------------stack-------------------------------------]
0000| 0xffffde08 --> 0x5655558b (<main+24>:	add    esp,0xc)
0004| 0xffffde0c --> 0x1
0008| 0xffffde10 --> 0x2
0012| 0xffffde14 --> 0x3
0016| 0xffffde18 --> 0x0
0020| 0xffffde1c --> 0xf7e0b286 (<__libc_start_main+246>:	add    esp,0x10)
0024| 0xffffde20 --> 0x1
0028| 0xffffde24 --> 0xffffdeb4 --> 0xffffdf85 ("/mnt/exercises/assembly/exploits/stack")


13) After `=> 0x56555572 <function+18>:	ret` 
[----------------------------------registers-----------------------------------]
EAX: 0x56557000 --> 0x1ef8
EBX: 0x0
ECX: 0x8e1acc15
EDX: 0xffffde44 --> 0x0
ESI: 0x1
EDI: 0xf7fa7000 --> 0x1b3db0
EBP: 0xffffde18 --> 0x0
ESP: 0xffffde0c --> 0x1
EIP: 0x5655558b (<main+24>:	add    esp,0xc)
EFLAGS: 0x216 (carry PARITY ADJUST zero sign trap INTERRUPT direction overflow)
[------------------------------------stack-------------------------------------]
0000| 0xffffde0c --> 0x1
0004| 0xffffde10 --> 0x2
0008| 0xffffde14 --> 0x3
0012| 0xffffde18 --> 0x0
0016| 0xffffde1c --> 0xf7e0b286 (<__libc_start_main+246>:	add    esp,0x10)
0020| 0xffffde20 --> 0x1
0024| 0xffffde24 --> 0xffffdeb4 --> 0xffffdf85 ("/mnt/exercises/assembly/exploits/stack")
0028| 0xffffde28 --> 0xffffdebc --> 0xffffdfac ("PWD=/mnt/exercises/assembly/exploits")